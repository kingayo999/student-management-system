import{u as C,j as e,s as g}from"./index-B6BQ_5Jc.js";import{r as l}from"./vendor-react-DPUOiDZ6.js";import{l as y}from"./logger-CdRFjmXn.js";import{S as b,g as A,i as w,K as j,A as P,s as z,X as E,h as K,L as N,f as U}from"./vendor-icons-DAIYLrmQ.js";import"./vendor-supabase-BZ0N5lZN.js";const D=()=>{const{profile:n,user:i,refreshProfile:v}=C(),[o,c]=l.useState(!1),[m,x]=l.useState(!1),[k,p]=l.useState(!1),[h,f]=l.useState(n?.full_name||""),[r,u]=l.useState({new:"",confirm:""}),[d,a]=l.useState({type:"",text:""}),_=async s=>{s.preventDefault(),c(!0),a({type:"",text:""});try{const{error:t}=await g.from("profiles").update({full_name:h}).eq("id",i.id);if(t)throw t;await y("update_profile","profiles",i.id),await v(),a({type:"success",text:"Identity designated successfully"}),setTimeout(()=>{x(!1),a({type:"",text:""})},2e3)}catch(t){a({type:"error",text:t.message})}finally{c(!1)}},S=async s=>{if(s.preventDefault(),r.new!==r.confirm){a({type:"error",text:"Security keys do not match"});return}c(!0),a({type:"",text:""});try{const{error:t}=await g.auth.updateUser({password:r.new});if(t)throw t;await y("change_password","profiles",i.id),a({type:"success",text:"Security key rotated successfully"}),setTimeout(()=>{p(!1),u({new:"",confirm:""}),a({type:"",text:""})},2e3)}catch(t){a({type:"error",text:t.message})}finally{c(!1)}};return e.jsxs("div",{className:"max-w-4xl mx-auto space-y-12 animate-in fade-in slide-in-from-bottom-4 duration-700",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-8 pb-6 border-b border-primary-100/50",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-12 h-1 bg-primary-950 rounded-full"}),e.jsx("p",{className:"text-[10px] font-black text-primary-500 uppercase tracking-[0.4em]",children:"Personal Protocol"})]}),e.jsxs("h1",{className:"text-5xl font-black text-primary-950 tracking-tighter italic font-heading",children:["User ",e.jsx("span",{className:"text-primary-600",children:"Command"})]})]})}),e.jsxs("div",{className:"academic-card overflow-hidden group",children:[e.jsxs("div",{className:"h-40 bg-gradient-to-r from-primary-900 via-primary-950 to-indigo-950 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 opacity-[0.05] bg-[radial-gradient(#fff_1px,transparent_1px)] [background-size:20px_20px]"}),e.jsx("div",{className:"absolute -bottom-24 -right-24 w-64 h-64 bg-accent-500/10 rounded-full blur-3xl"})]}),e.jsxs("div",{className:"px-10 pb-12 relative",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end gap-8 -mt-16 mb-12",children:[e.jsxs("div",{className:"w-32 h-32 rounded-[2.5rem] bg-white p-2 shadow-2xl relative group/avatar",children:[e.jsx("div",{className:"w-full h-full rounded-[2rem] bg-gradient-to-br from-primary-600 to-indigo-800 flex items-center justify-center text-white text-4xl font-black shadow-inner",children:n?.full_name?.charAt(0)}),e.jsx("div",{className:"absolute bottom-1 right-1 w-8 h-8 bg-emerald-500 border-4 border-white rounded-2xl shadow-lg"})]}),e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx("h2",{className:"text-3xl font-black text-primary-950 tracking-tighter uppercase italic font-heading",children:n?.full_name}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("span",{className:"flex items-center gap-2 px-4 py-2 bg-primary-50 rounded-xl text-[10px] font-black text-primary-700 uppercase tracking-widest border border-primary-100/50",children:[e.jsx(b,{className:"w-3.5 h-3.5 text-accent-500"}),n?.role," Authorization"]}),e.jsxs("span",{className:"flex items-center gap-2 px-4 py-2 bg-gray-50 rounded-xl text-[10px] font-black text-gray-500 uppercase tracking-widest border border-gray-100/50",children:[e.jsx(A,{className:"w-3.5 h-3.5"}),i?.email]})]})]}),e.jsxs("button",{onClick:()=>{f(n?.full_name||""),x(!0)},className:"btn-primary !py-4 group",children:[e.jsx(w,{className:"w-4 h-4 group-hover:rotate-12 transition-transform"}),"Modify Identity"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"p-8 rounded-3xl bg-slate-50/50 border border-slate-100 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2.5 bg-white rounded-xl shadow-sm border border-slate-100",children:e.jsx(j,{className:"w-4 h-4 text-primary-600"})}),e.jsx("h3",{className:"text-xs font-black text-primary-900 uppercase tracking-widest",children:"Authentication Protocol"})]}),e.jsx("p",{className:"text-sm text-gray-500 font-medium leading-relaxed",children:"Ensure your terminal access is secure by rotating your authorized secure key regularly."}),e.jsxs("button",{onClick:()=>p(!0),className:"text-[10px] font-black text-primary-700 uppercase tracking-[0.2em] flex items-center gap-2 hover:gap-4 transition-all",children:["Rotate Access Key ",e.jsx(P,{className:"w-3.5 h-3.5"})]})]}),e.jsxs("div",{className:"p-8 rounded-3xl bg-primary-50/30 border border-primary-50 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2.5 bg-white rounded-xl shadow-sm border border-primary-50",children:e.jsx(z,{className:"w-4 h-4 text-primary-600"})}),e.jsx("h3",{className:"text-xs font-black text-primary-900 uppercase tracking-widest",children:"Command History"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-[9px] font-black text-primary-400 uppercase tracking-widest mb-1",children:"Last Entrance Detected"}),e.jsx("p",{className:"text-sm font-black text-primary-950",children:i?.last_sign_in_at?new Date(i.last_sign_in_at).toLocaleString():"N/A"})]})]})]})]})]}),(m||k)&&e.jsx("div",{className:"fixed inset-0 bg-primary-950/40 backdrop-blur-xl z-50 flex items-center justify-center p-6 animate-in fade-in duration-500",children:e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-2xl w-full max-w-md overflow-hidden border border-white/20 animate-in zoom-in duration-500",children:[e.jsxs("div",{className:"p-10 border-b border-primary-50 flex items-center justify-between bg-gradient-to-br from-primary-900 to-indigo-950 text-white relative",children:[e.jsx("div",{className:"absolute inset-0 opacity-[0.05] bg-[radial-gradient(#fff_1px,transparent_1px)] [background-size:20px_20px]"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("h2",{className:"text-2xl font-black tracking-tighter uppercase italic font-heading",children:m?"Identity Update":"Key Rotation"}),e.jsx("p",{className:"text-[10px] font-black text-primary-400 uppercase tracking-[0.3em] mt-1.5",children:"Authorized Protocol"})]}),e.jsx("button",{onClick:()=>{x(!1),p(!1),a({type:"",text:""})},className:"text-white/50 hover:text-white transition-colors bg-white/5 p-3 rounded-2xl relative z-10",children:e.jsx(E,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-10",children:[d.text&&e.jsxs("div",{className:`mb-8 p-5 rounded-2xl border flex items-center gap-4 animate-in slide-in-from-top duration-500 ${d.type==="success"?"bg-emerald-50 border-emerald-100 text-emerald-800":"bg-red-50 border-red-100 text-red-800"}`,children:[d.type==="success"?e.jsx(K,{className:"w-5 h-5"}):e.jsx(b,{className:"w-5 h-5"}),e.jsx("p",{className:"text-[11px] font-black uppercase tracking-tight",children:d.text})]}),m?e.jsxs("form",{onSubmit:_,className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-primary-400 uppercase tracking-[0.3em] mb-3 ml-1",children:"New Identity Designation"}),e.jsxs("div",{className:"relative group",children:[e.jsx(w,{className:"absolute left-6 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-300 group-focus-within:text-primary-600 transition-colors"}),e.jsx("input",{required:!0,className:"w-full pl-16 pr-8 py-5 bg-gray-50/50 rounded-2xl border border-gray-100 focus:bg-white focus:border-primary-600 focus:ring-4 focus:ring-primary-100/50 outline-none text-sm font-bold text-primary-950 transition-all",value:h,onChange:s=>f(s.target.value)})]})]}),e.jsx("button",{disabled:o,className:"btn-primary w-full py-5 !rounded-2xl shadow-xl shadow-primary-900/20 active:scale-95 transition-all",children:o?e.jsx(N,{className:"w-5 h-5 animate-spin"}):"Confirm Identity"})]}):e.jsxs("form",{onSubmit:S,className:"space-y-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-primary-400 uppercase tracking-[0.3em] mb-3 ml-1",children:"New Secure Key"}),e.jsxs("div",{className:"relative group",children:[e.jsx(j,{className:"absolute left-6 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-300 group-focus-within:text-primary-600 transition-colors"}),e.jsx("input",{type:"password",required:!0,className:"w-full pl-16 pr-8 py-5 bg-gray-50/50 rounded-2xl border border-gray-100 focus:bg-white focus:border-primary-600 focus:ring-4 focus:ring-primary-100/50 outline-none text-sm font-bold text-primary-950 transition-all",value:r.new,onChange:s=>u({...r,new:s.target.value})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-primary-400 uppercase tracking-[0.3em] mb-3 ml-1",children:"Confirm Matrix Entry"}),e.jsxs("div",{className:"relative group",children:[e.jsx(U,{className:"absolute left-6 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-300 group-focus-within:text-primary-600 transition-colors"}),e.jsx("input",{type:"password",required:!0,className:"w-full pl-16 pr-8 py-5 bg-gray-50/50 rounded-2xl border border-gray-100 focus:bg-white focus:border-primary-600 focus:ring-4 focus:ring-primary-100/50 outline-none text-sm font-bold text-primary-950 transition-all",value:r.confirm,onChange:s=>u({...r,confirm:s.target.value})})]})]})]}),e.jsx("button",{disabled:o,className:"btn-primary w-full py-5 !rounded-2xl shadow-xl shadow-primary-900/20 active:scale-95 transition-all",children:o?e.jsx(N,{className:"w-5 h-5 animate-spin"}):"Execute Key Rotation"})]})]})]})})]})};D.propTypes={};export{D as default};
