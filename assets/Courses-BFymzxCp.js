import{j as e,s as _,P as x,R as I,u as qe}from"./index-BQ8WljgO.js";import{e as R,r as j}from"./vendor-react-DPUOiDZ6.js";import{l as W}from"./logger-CBR2vuei.js";import{u as $e,a as Qe}from"./useDebounce-XaSDqtCT.js";import{h as Ge}from"./errorHandler-CWQmkH48.js";import{X as de,L as ee,q as te,h as he,o as fe,m as He,F as pe,n as le,G as Ye,r as Ve}from"./vendor-icons-DAIYLrmQ.js";import"./vendor-supabase-BZ0N5lZN.js";var Xe=Object.defineProperty,re=Object.getOwnPropertySymbols,ge=Object.prototype.hasOwnProperty,be=Object.prototype.propertyIsEnumerable,xe=(c,o,i)=>o in c?Xe(c,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[o]=i,oe=(c,o)=>{for(var i in o||(o={}))ge.call(o,i)&&xe(c,i,o[i]);if(re)for(var i of re(o))be.call(o,i)&&xe(c,i,o[i]);return c},ce=(c,o)=>{var i={};for(var l in c)ge.call(c,l)&&o.indexOf(l)<0&&(i[l]=c[l]);if(c!=null&&re)for(var l of re(c))o.indexOf(l)<0&&be.call(c,l)&&(i[l]=c[l]);return i};var $;(c=>{const o=class y{constructor(t,s,r,a){if(this.version=t,this.errorCorrectionLevel=s,this.modules=[],this.isFunction=[],t<y.MIN_VERSION||t>y.MAX_VERSION)throw new RangeError("Version value out of range");if(a<-1||a>7)throw new RangeError("Mask value out of range");this.size=t*4+17;let n=[];for(let d=0;d<this.size;d++)n.push(!1);for(let d=0;d<this.size;d++)this.modules.push(n.slice()),this.isFunction.push(n.slice());this.drawFunctionPatterns();const h=this.addEccAndInterleave(r);if(this.drawCodewords(h),a==-1){let d=1e9;for(let g=0;g<8;g++){this.applyMask(g),this.drawFormatBits(g);const f=this.getPenaltyScore();f<d&&(a=g,d=f),this.applyMask(g)}}u(0<=a&&a<=7),this.mask=a,this.applyMask(a),this.drawFormatBits(a),this.isFunction=[]}static encodeText(t,s){const r=c.QrSegment.makeSegments(t);return y.encodeSegments(r,s)}static encodeBinary(t,s){const r=c.QrSegment.makeBytes(t);return y.encodeSegments([r],s)}static encodeSegments(t,s,r=1,a=40,n=-1,h=!0){if(!(y.MIN_VERSION<=r&&r<=a&&a<=y.MAX_VERSION)||n<-1||n>7)throw new RangeError("Invalid value");let d,g;for(d=r;;d++){const b=y.getNumDataCodewords(d,s)*8,C=N.getTotalBits(t,d);if(C<=b){g=C;break}if(d>=a)throw new RangeError("Data too long")}for(const b of[y.Ecc.MEDIUM,y.Ecc.QUARTILE,y.Ecc.HIGH])h&&g<=y.getNumDataCodewords(d,b)*8&&(s=b);let f=[];for(const b of t){i(b.mode.modeBits,4,f),i(b.numChars,b.mode.numCharCountBits(d),f);for(const C of b.getData())f.push(C)}u(f.length==g);const S=y.getNumDataCodewords(d,s)*8;u(f.length<=S),i(0,Math.min(4,S-f.length),f),i(0,(8-f.length%8)%8,f),u(f.length%8==0);for(let b=236;f.length<S;b^=253)i(b,8,f);let k=[];for(;k.length*8<f.length;)k.push(0);return f.forEach((b,C)=>k[C>>>3]|=b<<7-(C&7)),new y(d,s,k,n)}getModule(t,s){return 0<=t&&t<this.size&&0<=s&&s<this.size&&this.modules[s][t]}getModules(){return this.modules}drawFunctionPatterns(){for(let r=0;r<this.size;r++)this.setFunctionModule(6,r,r%2==0),this.setFunctionModule(r,6,r%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const t=this.getAlignmentPatternPositions(),s=t.length;for(let r=0;r<s;r++)for(let a=0;a<s;a++)r==0&&a==0||r==0&&a==s-1||r==s-1&&a==0||this.drawAlignmentPattern(t[r],t[a]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(t){const s=this.errorCorrectionLevel.formatBits<<3|t;let r=s;for(let n=0;n<10;n++)r=r<<1^(r>>>9)*1335;const a=(s<<10|r)^21522;u(a>>>15==0);for(let n=0;n<=5;n++)this.setFunctionModule(8,n,l(a,n));this.setFunctionModule(8,7,l(a,6)),this.setFunctionModule(8,8,l(a,7)),this.setFunctionModule(7,8,l(a,8));for(let n=9;n<15;n++)this.setFunctionModule(14-n,8,l(a,n));for(let n=0;n<8;n++)this.setFunctionModule(this.size-1-n,8,l(a,n));for(let n=8;n<15;n++)this.setFunctionModule(8,this.size-15+n,l(a,n));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let t=this.version;for(let r=0;r<12;r++)t=t<<1^(t>>>11)*7973;const s=this.version<<12|t;u(s>>>18==0);for(let r=0;r<18;r++){const a=l(s,r),n=this.size-11+r%3,h=Math.floor(r/3);this.setFunctionModule(n,h,a),this.setFunctionModule(h,n,a)}}drawFinderPattern(t,s){for(let r=-4;r<=4;r++)for(let a=-4;a<=4;a++){const n=Math.max(Math.abs(a),Math.abs(r)),h=t+a,d=s+r;0<=h&&h<this.size&&0<=d&&d<this.size&&this.setFunctionModule(h,d,n!=2&&n!=4)}}drawAlignmentPattern(t,s){for(let r=-2;r<=2;r++)for(let a=-2;a<=2;a++)this.setFunctionModule(t+a,s+r,Math.max(Math.abs(a),Math.abs(r))!=1)}setFunctionModule(t,s,r){this.modules[s][t]=r,this.isFunction[s][t]=!0}addEccAndInterleave(t){const s=this.version,r=this.errorCorrectionLevel;if(t.length!=y.getNumDataCodewords(s,r))throw new RangeError("Invalid argument");const a=y.NUM_ERROR_CORRECTION_BLOCKS[r.ordinal][s],n=y.ECC_CODEWORDS_PER_BLOCK[r.ordinal][s],h=Math.floor(y.getNumRawDataModules(s)/8),d=a-h%a,g=Math.floor(h/a);let f=[];const S=y.reedSolomonComputeDivisor(n);for(let b=0,C=0;b<a;b++){let M=t.slice(C,C+g-n+(b<d?0:1));C+=M.length;const z=y.reedSolomonComputeRemainder(M,S);b<d&&M.push(0),f.push(M.concat(z))}let k=[];for(let b=0;b<f[0].length;b++)f.forEach((C,M)=>{(b!=g-n||M>=d)&&k.push(C[b])});return u(k.length==h),k}drawCodewords(t){if(t.length!=Math.floor(y.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let s=0;for(let r=this.size-1;r>=1;r-=2){r==6&&(r=5);for(let a=0;a<this.size;a++)for(let n=0;n<2;n++){const h=r-n,g=(r+1&2)==0?this.size-1-a:a;!this.isFunction[g][h]&&s<t.length*8&&(this.modules[g][h]=l(t[s>>>3],7-(s&7)),s++)}}u(s==t.length*8)}applyMask(t){if(t<0||t>7)throw new RangeError("Mask value out of range");for(let s=0;s<this.size;s++)for(let r=0;r<this.size;r++){let a;switch(t){case 0:a=(r+s)%2==0;break;case 1:a=s%2==0;break;case 2:a=r%3==0;break;case 3:a=(r+s)%3==0;break;case 4:a=(Math.floor(r/3)+Math.floor(s/2))%2==0;break;case 5:a=r*s%2+r*s%3==0;break;case 6:a=(r*s%2+r*s%3)%2==0;break;case 7:a=((r+s)%2+r*s%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[s][r]&&a&&(this.modules[s][r]=!this.modules[s][r])}}getPenaltyScore(){let t=0;for(let n=0;n<this.size;n++){let h=!1,d=0,g=[0,0,0,0,0,0,0];for(let f=0;f<this.size;f++)this.modules[n][f]==h?(d++,d==5?t+=y.PENALTY_N1:d>5&&t++):(this.finderPenaltyAddHistory(d,g),h||(t+=this.finderPenaltyCountPatterns(g)*y.PENALTY_N3),h=this.modules[n][f],d=1);t+=this.finderPenaltyTerminateAndCount(h,d,g)*y.PENALTY_N3}for(let n=0;n<this.size;n++){let h=!1,d=0,g=[0,0,0,0,0,0,0];for(let f=0;f<this.size;f++)this.modules[f][n]==h?(d++,d==5?t+=y.PENALTY_N1:d>5&&t++):(this.finderPenaltyAddHistory(d,g),h||(t+=this.finderPenaltyCountPatterns(g)*y.PENALTY_N3),h=this.modules[f][n],d=1);t+=this.finderPenaltyTerminateAndCount(h,d,g)*y.PENALTY_N3}for(let n=0;n<this.size-1;n++)for(let h=0;h<this.size-1;h++){const d=this.modules[n][h];d==this.modules[n][h+1]&&d==this.modules[n+1][h]&&d==this.modules[n+1][h+1]&&(t+=y.PENALTY_N2)}let s=0;for(const n of this.modules)s=n.reduce((h,d)=>h+(d?1:0),s);const r=this.size*this.size,a=Math.ceil(Math.abs(s*20-r*10)/r)-1;return u(0<=a&&a<=9),t+=a*y.PENALTY_N4,u(0<=t&&t<=2568888),t}getAlignmentPatternPositions(){if(this.version==1)return[];{const t=Math.floor(this.version/7)+2,s=this.version==32?26:Math.ceil((this.version*4+4)/(t*2-2))*2;let r=[6];for(let a=this.size-7;r.length<t;a-=s)r.splice(1,0,a);return r}}static getNumRawDataModules(t){if(t<y.MIN_VERSION||t>y.MAX_VERSION)throw new RangeError("Version number out of range");let s=(16*t+128)*t+64;if(t>=2){const r=Math.floor(t/7)+2;s-=(25*r-10)*r-55,t>=7&&(s-=36)}return u(208<=s&&s<=29648),s}static getNumDataCodewords(t,s){return Math.floor(y.getNumRawDataModules(t)/8)-y.ECC_CODEWORDS_PER_BLOCK[s.ordinal][t]*y.NUM_ERROR_CORRECTION_BLOCKS[s.ordinal][t]}static reedSolomonComputeDivisor(t){if(t<1||t>255)throw new RangeError("Degree out of range");let s=[];for(let a=0;a<t-1;a++)s.push(0);s.push(1);let r=1;for(let a=0;a<t;a++){for(let n=0;n<s.length;n++)s[n]=y.reedSolomonMultiply(s[n],r),n+1<s.length&&(s[n]^=s[n+1]);r=y.reedSolomonMultiply(r,2)}return s}static reedSolomonComputeRemainder(t,s){let r=s.map(a=>0);for(const a of t){const n=a^r.shift();r.push(0),s.forEach((h,d)=>r[d]^=y.reedSolomonMultiply(h,n))}return r}static reedSolomonMultiply(t,s){if(t>>>8||s>>>8)throw new RangeError("Byte out of range");let r=0;for(let a=7;a>=0;a--)r=r<<1^(r>>>7)*285,r^=(s>>>a&1)*t;return u(r>>>8==0),r}finderPenaltyCountPatterns(t){const s=t[1];u(s<=this.size*3);const r=s>0&&t[2]==s&&t[3]==s*3&&t[4]==s&&t[5]==s;return(r&&t[0]>=s*4&&t[6]>=s?1:0)+(r&&t[6]>=s*4&&t[0]>=s?1:0)}finderPenaltyTerminateAndCount(t,s,r){return t&&(this.finderPenaltyAddHistory(s,r),s=0),s+=this.size,this.finderPenaltyAddHistory(s,r),this.finderPenaltyCountPatterns(r)}finderPenaltyAddHistory(t,s){s[0]==0&&(t+=this.size),s.pop(),s.unshift(t)}};o.MIN_VERSION=1,o.MAX_VERSION=40,o.PENALTY_N1=3,o.PENALTY_N2=3,o.PENALTY_N3=40,o.PENALTY_N4=10,o.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],o.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],c.QrCode=o;function i(w,t,s){if(t<0||t>31||w>>>t)throw new RangeError("Value out of range");for(let r=t-1;r>=0;r--)s.push(w>>>r&1)}function l(w,t){return(w>>>t&1)!=0}function u(w){if(!w)throw new Error("Assertion error")}const p=class E{constructor(t,s,r){if(this.mode=t,this.numChars=s,this.bitData=r,s<0)throw new RangeError("Invalid argument");this.bitData=r.slice()}static makeBytes(t){let s=[];for(const r of t)i(r,8,s);return new E(E.Mode.BYTE,t.length,s)}static makeNumeric(t){if(!E.isNumeric(t))throw new RangeError("String contains non-numeric characters");let s=[];for(let r=0;r<t.length;){const a=Math.min(t.length-r,3);i(parseInt(t.substring(r,r+a),10),a*3+1,s),r+=a}return new E(E.Mode.NUMERIC,t.length,s)}static makeAlphanumeric(t){if(!E.isAlphanumeric(t))throw new RangeError("String contains unencodable characters in alphanumeric mode");let s=[],r;for(r=0;r+2<=t.length;r+=2){let a=E.ALPHANUMERIC_CHARSET.indexOf(t.charAt(r))*45;a+=E.ALPHANUMERIC_CHARSET.indexOf(t.charAt(r+1)),i(a,11,s)}return r<t.length&&i(E.ALPHANUMERIC_CHARSET.indexOf(t.charAt(r)),6,s),new E(E.Mode.ALPHANUMERIC,t.length,s)}static makeSegments(t){return t==""?[]:E.isNumeric(t)?[E.makeNumeric(t)]:E.isAlphanumeric(t)?[E.makeAlphanumeric(t)]:[E.makeBytes(E.toUtf8ByteArray(t))]}static makeEci(t){let s=[];if(t<0)throw new RangeError("ECI assignment value out of range");if(t<128)i(t,8,s);else if(t<16384)i(2,2,s),i(t,14,s);else if(t<1e6)i(6,3,s),i(t,21,s);else throw new RangeError("ECI assignment value out of range");return new E(E.Mode.ECI,0,s)}static isNumeric(t){return E.NUMERIC_REGEX.test(t)}static isAlphanumeric(t){return E.ALPHANUMERIC_REGEX.test(t)}getData(){return this.bitData.slice()}static getTotalBits(t,s){let r=0;for(const a of t){const n=a.mode.numCharCountBits(s);if(a.numChars>=1<<n)return 1/0;r+=4+n+a.bitData.length}return r}static toUtf8ByteArray(t){t=encodeURI(t);let s=[];for(let r=0;r<t.length;r++)t.charAt(r)!="%"?s.push(t.charCodeAt(r)):(s.push(parseInt(t.substring(r+1,r+3),16)),r+=2);return s}};p.NUMERIC_REGEX=/^[0-9]*$/,p.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,p.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let N=p;c.QrSegment=p})($||($={}));(c=>{(o=>{const i=class{constructor(u,p){this.ordinal=u,this.formatBits=p}};i.LOW=new i(0,1),i.MEDIUM=new i(1,0),i.QUARTILE=new i(2,3),i.HIGH=new i(3,2),o.Ecc=i})(c.QrCode||(c.QrCode={}))})($||($={}));(c=>{(o=>{const i=class{constructor(u,p){this.modeBits=u,this.numBitsCharCount=p}numCharCountBits(u){return this.numBitsCharCount[Math.floor((u+7)/17)]}};i.NUMERIC=new i(1,[10,12,14]),i.ALPHANUMERIC=new i(2,[9,11,13]),i.BYTE=new i(4,[8,16,16]),i.KANJI=new i(8,[8,10,12]),i.ECI=new i(7,[0,0,0]),o.Mode=i})(c.QrSegment||(c.QrSegment={}))})($||($={}));var Y=$;var We={L:Y.QrCode.Ecc.LOW,M:Y.QrCode.Ecc.MEDIUM,Q:Y.QrCode.Ecc.QUARTILE,H:Y.QrCode.Ecc.HIGH},ye=128,we="L",ve="#FFFFFF",Ne="#000000",je=!1,Ce=1,Ke=4,Ze=0,Je=.1;function Ee(c,o=0){const i=[];return c.forEach(function(l,u){let p=null;l.forEach(function(N,w){if(!N&&p!==null){i.push(`M${p+o} ${u+o}h${w-p}v1H${p+o}z`),p=null;return}if(w===l.length-1){if(!N)return;p===null?i.push(`M${w+o},${u+o} h1v1H${w+o}z`):i.push(`M${p+o},${u+o} h${w+1-p}v1H${p+o}z`);return}N&&p===null&&(p=w)})}),i.join("")}function ke(c,o){return c.slice().map((i,l)=>l<o.y||l>=o.y+o.h?i:i.map((u,p)=>p<o.x||p>=o.x+o.w?u:!1))}function et(c,o,i,l){if(l==null)return null;const u=c.length+i*2,p=Math.floor(o*Je),N=u/o,w=(l.width||p)*N,t=(l.height||p)*N,s=l.x==null?c.length/2-w/2:l.x*N,r=l.y==null?c.length/2-t/2:l.y*N,a=l.opacity==null?1:l.opacity;let n=null;if(l.excavate){let d=Math.floor(s),g=Math.floor(r),f=Math.ceil(w+s-d),S=Math.ceil(t+r-g);n={x:d,y:g,w:f,h:S}}const h=l.crossOrigin;return{x:s,y:r,h:t,w,excavation:n,opacity:a,crossOrigin:h}}function tt(c,o){return o!=null?Math.max(Math.floor(o),0):c?Ke:Ze}function Se({value:c,level:o,minVersion:i,includeMargin:l,marginSize:u,imageSettings:p,size:N,boostLevel:w}){let t=R.useMemo(()=>{const d=(Array.isArray(c)?c:[c]).reduce((g,f)=>(g.push(...Y.QrSegment.makeSegments(f)),g),[]);return Y.QrCode.encodeSegments(d,We[o],i,void 0,void 0,w)},[c,o,i,w]);const{cells:s,margin:r,numCells:a,calculatedImageSettings:n}=R.useMemo(()=>{let h=t.getModules();const d=tt(l,u),g=h.length+d*2,f=et(h,N,d,p);return{cells:h,margin:d,numCells:g,calculatedImageSettings:f}},[t,N,p,l,u]);return{qrcode:t,margin:r,cells:s,numCells:a,calculatedImageSettings:n}}var rt=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),st=R.forwardRef(function(o,i){const l=o,{value:u,size:p=ye,level:N=we,bgColor:w=ve,fgColor:t=Ne,includeMargin:s=je,minVersion:r=Ce,boostLevel:a,marginSize:n,imageSettings:h}=l,g=ce(l,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:f}=g,S=ce(g,["style"]),k=h?.src,b=R.useRef(null),C=R.useRef(null),M=R.useCallback(T=>{b.current=T,typeof i=="function"?i(T):i&&(i.current=T)},[i]),[z,K]=R.useState(!1),{margin:U,cells:O,numCells:D,calculatedImageSettings:A}=Se({value:u,level:N,minVersion:r,boostLevel:a,includeMargin:s,marginSize:n,imageSettings:h,size:p});R.useEffect(()=>{if(b.current!=null){const T=b.current,P=T.getContext("2d");if(!P)return;let F=O;const B=C.current,Z=A!=null&&B!==null&&B.complete&&B.naturalHeight!==0&&B.naturalWidth!==0;Z&&A.excavation!=null&&(F=ke(O,A.excavation));const J=window.devicePixelRatio||1;T.height=T.width=p*J;const Q=p/D*J;P.scale(Q,Q),P.fillStyle=w,P.fillRect(0,0,D,D),P.fillStyle=t,rt?P.fill(new Path2D(Ee(F,U))):O.forEach(function(ie,X){ie.forEach(function(G,H){G&&P.fillRect(H+U,X+U,1,1)})}),A&&(P.globalAlpha=A.opacity),Z&&P.drawImage(B,A.x+U,A.y+U,A.w,A.h)}}),R.useEffect(()=>{K(!1)},[k]);const ae=oe({height:p,width:p},f);let V=null;return k!=null&&(V=R.createElement("img",{src:k,key:k,style:{display:"none"},onLoad:()=>{K(!0)},ref:C,crossOrigin:A?.crossOrigin})),R.createElement(R.Fragment,null,R.createElement("canvas",oe({style:ae,height:p,width:p,ref:M,role:"img"},S)),V)});st.displayName="QRCodeCanvas";var Re=R.forwardRef(function(o,i){const l=o,{value:u,size:p=ye,level:N=we,bgColor:w=ve,fgColor:t=Ne,includeMargin:s=je,minVersion:r=Ce,boostLevel:a,title:n,marginSize:h,imageSettings:d}=l,g=ce(l,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:f,cells:S,numCells:k,calculatedImageSettings:b}=Se({value:u,level:N,minVersion:r,boostLevel:a,includeMargin:s,marginSize:h,imageSettings:d,size:p});let C=S,M=null;d!=null&&b!=null&&(b.excavation!=null&&(C=ke(S,b.excavation)),M=R.createElement("image",{href:d.src,height:b.h,width:b.w,x:b.x+f,y:b.y+f,preserveAspectRatio:"none",opacity:b.opacity,crossOrigin:b.crossOrigin}));const z=Ee(C,f);return R.createElement("svg",oe({height:p,width:p,viewBox:`0 0 ${k} ${k}`,ref:i,role:"img"},g),!!n&&R.createElement("title",null,n),R.createElement("path",{fill:w,d:`M0,0 h${k}v${k}H0z`,shapeRendering:"crispEdges"}),R.createElement("path",{fill:t,d:z,shapeRendering:"crispEdges"}),M)});Re.displayName="QRCodeSVG";const at=({courses:c,student:o,totalUnits:i})=>{const l=`Name:${o?.full_name||"N/A"}|Matric:${o?.matric_no||"N/A"}|Session:2024/2025|Units:${i}`;return e.jsxs("div",{className:"bg-white p-8 max-w-[210mm] mx-auto min-h-[297mm] shadow-2xl print:shadow-none print:w-full print:max-w-none",children:[e.jsxs("div",{className:"text-center mb-8 border-b-2 border-gray-800 pb-4",children:[e.jsxs("div",{className:"mb-4 flex flex-col items-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-full mb-2 flex items-center justify-center text-[10px] font-bold text-gray-500",children:"LOGO"}),e.jsx("img",{src:"/path/to/logo.png",alt:"University Logo",className:"w-20 h-20 object-contain mb-2 hidden",onError:u=>u.target.style.display="none"}),e.jsx("h1",{className:"text-lg font-bold uppercase tracking-wide text-gray-900 font-serif",children:"Bells University of Technology, Ota, Ogun State"}),e.jsx("p",{className:"text-sm font-bold uppercase text-gray-700 font-serif",children:"College of Engineering"}),e.jsx("p",{className:"text-xs font-bold uppercase text-gray-600 font-serif",children:"Department of Computer Engineering"})]}),e.jsxs("div",{className:"flex flex-wrap justify-between items-center text-[10px] sm:text-xs font-bold border-y border-gray-300 py-2 mt-4 font-sans",children:[e.jsxs("div",{className:"w-full sm:w-auto mb-1 sm:mb-0",children:[e.jsx("span",{className:"text-gray-500 mr-1",children:"Name:"})," ",o?.full_name||"OLAYANJU AYOBAMI ABRAHAM"]}),e.jsxs("div",{className:"w-full sm:w-auto mb-1 sm:mb-0",children:[e.jsx("span",{className:"text-gray-500 mr-1",children:"Matric No:"})," ",o?.matric_no||"2024/13522"]}),e.jsxs("div",{className:"w-full sm:w-auto mb-1 sm:mb-0",children:[e.jsx("span",{className:"text-gray-500 mr-1",children:"Level:"})," 200"]}),e.jsxs("div",{className:"w-full sm:w-auto mb-1 sm:mb-0",children:[e.jsx("span",{className:"text-gray-500 mr-1",children:"Session:"})," 2024/2025"]}),e.jsxs("div",{className:"w-full sm:w-auto",children:[e.jsx("span",{className:"text-gray-500 mr-1",children:"Semester:"})," FIRST"]})]})]}),e.jsx("h2",{className:"text-center font-bold text-base uppercase mb-6 font-sans tracking-wider border-b border-gray-200 pb-2 w-fit mx-auto",children:"Course Registration"}),e.jsx("div",{className:"border border-gray-300 rounded-sm overflow-hidden mb-8",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 border-b border-gray-300",children:[e.jsx("th",{className:"px-4 py-2 text-xs font-bold text-gray-500 uppercase border-r border-gray-300 w-1/4",children:"Course Code"}),e.jsx("th",{className:"px-4 py-2 text-xs font-bold text-gray-500 uppercase border-r border-gray-300 w-1/2",children:"Course Title"}),e.jsx("th",{className:"px-4 py-2 text-xs font-bold text-gray-500 uppercase text-center w-1/4",children:"Units"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-200",children:[c.length>0?c.map((u,p)=>e.jsxs("tr",{className:"hover:bg-gray-50/50",children:[e.jsx("td",{className:"px-4 py-2.5 text-xs font-bold text-gray-800 border-r border-gray-200 font-mono",children:u.code}),e.jsx("td",{className:"px-4 py-2.5 text-xs font-medium text-gray-700 border-r border-gray-200 uppercase",children:u.name}),e.jsx("td",{className:"px-4 py-2.5 text-xs font-bold text-gray-800 text-center",children:u.credit_unit})]},u.id||p)):e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"px-4 py-8 text-center text-xs text-gray-400 italic",children:"No courses registered."})}),e.jsxs("tr",{className:"bg-gray-50 border-t-2 border-gray-300",children:[e.jsx("td",{colSpan:"2",className:"px-4 py-3 text-right text-xs font-bold text-gray-900 uppercase",children:"Total Units Registered:"}),e.jsx("td",{className:"px-4 py-3 text-center text-sm font-black text-gray-900",children:i})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 mt-16 pt-8 text-center bg-transparent",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-full h-px bg-black mb-2"}),e.jsx("p",{className:"text-[10px] font-bold uppercase text-gray-900",children:"Student"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-full h-px bg-black mb-2"}),e.jsx("p",{className:"text-[10px] font-bold uppercase text-gray-900",children:"Course Advisor"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-full h-px bg-black mb-2"}),e.jsx("p",{className:"text-[10px] font-bold uppercase text-gray-900",children:"Head of Department"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-full h-px bg-black mb-2"}),e.jsx("p",{className:"text-[10px] font-bold uppercase text-gray-900",children:"College Dean"})]})]}),e.jsx("div",{className:"flex justify-center mt-12",children:e.jsx("div",{className:"p-2 bg-white border border-gray-200 rounded-lg shadow-sm",children:e.jsx(Re,{value:l,size:96})})}),e.jsx("div",{className:"text-center mt-4",children:e.jsxs("p",{className:"text-[8px] text-gray-400 font-mono",children:["Generated via Student Portal â€¢ ",new Date().toLocaleDateString()]})})]})},it=()=>{const[c,o]=j.useState([]),[i,l]=j.useState(!1),[u,p]=j.useState(null),N=j.useCallback(async()=>{l(!0),p(null);try{const{data:r,error:a}=await _.from("courses").select(`
                    *,
                    departments:department_id (name, code)
                `).order("code");if(a)throw a;o(r||[])}catch(r){p(Ge(r,"fetch_courses"))}finally{l(!1)}},[]);return{courses:c,loading:i,error:u,fetchCourses:N,createCourse:async r=>{l(!0);try{const{data:a,error:n}=await _.from("courses").insert([{...r,code:r.code.toUpperCase()}]).select().single();if(n)throw n.code==="23505"?new Error("Course code already exists in the mainframe."):n;return await W("create_course","courses",a.id),await N(),{success:!0,data:a}}catch(a){return{success:!1,error:a.message}}finally{l(!1)}},updateCourse:async(r,a)=>{l(!0);try{const{error:n}=await _.from("courses").update({...a,code:a.code?.toUpperCase()}).eq("id",r);if(n)throw n;return await W("update_course","courses",r),await N(),{success:!0}}catch(n){return{success:!1,error:n.message}}finally{l(!1)}},deleteCourse:async r=>{l(!0);try{const{error:a}=await _.from("courses").delete().eq("id",r);if(a)throw a;return await W("delete_course","courses",r),o(n=>n.filter(h=>h.id!==r)),{success:!0}}catch{return{success:!1,error:"Authorization failure: Could not delete course."}}finally{l(!1)}}}},Me=({isOpen:c,onClose:o,onSubmit:i,courseData:l,onCourseDataChange:u,departments:p,submitting:N})=>{if(!c)return null;const w=t=>{t.preventDefault(),i(t)};return e.jsx("div",{className:"fixed inset-0 bg-primary-950/40 backdrop-blur-xl z-50 flex items-center justify-center p-6 animate-in fade-in duration-500",children:e.jsxs("div",{className:"bg-white rounded-[2rem] sm:rounded-[2.5rem] shadow-2xl w-full max-w-lg overflow-hidden border border-white/20 animate-in zoom-in duration-500",children:[e.jsxs("div",{className:"p-8 sm:p-10 border-b border-primary-50 flex items-center justify-between bg-gradient-to-br from-primary-900 to-primary-950 text-white relative",children:[e.jsx("div",{className:"absolute inset-x-0 bottom-0 h-1 bg-gradient-to-r from-accent-500 to-transparent"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-black tracking-tighter uppercase italic font-heading",children:"Provision Course"}),e.jsx("p",{className:"text-[9px] sm:text-[10px] font-black text-primary-400 uppercase tracking-[0.3em] mt-1 lg:mt-1.5",children:"Curriculum Architecture"})]}),e.jsx("button",{onClick:o,className:"text-white/50 hover:text-white transition-colors bg-white/5 p-2 sm:p-3 rounded-xl sm:rounded-2xl relative z-10",children:e.jsx(de,{className:"w-5 h-5 sm:w-6 sm:h-6"})})]}),e.jsxs("form",{onSubmit:w,className:"p-8 sm:p-10 space-y-6 sm:space-y-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-primary-400 uppercase tracking-[0.3em] mb-3 ml-1",children:"Course Identity Code"}),e.jsx("input",{required:!0,className:"input-field uppercase font-mono tracking-widest shadow-inner !bg-gray-50/50",placeholder:"e.g. ENG 201",value:l.code,onChange:t=>u({...l,code:t.target.value.toUpperCase()})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-primary-400 uppercase tracking-[0.3em] mb-3 ml-1",children:"Departmental Node"}),e.jsxs("select",{required:!0,className:"input-field appearance-none bg-gray-50/50 shadow-inner",value:l.department_id,onChange:t=>u({...l,department_id:t.target.value}),children:[e.jsx("option",{value:"",children:"Select Dept"}),p.map(t=>e.jsxs("option",{value:t.id,children:[t.name," (",t.code,")"]},t.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-primary-400 uppercase tracking-[0.3em] mb-3 ml-1",children:"Official Course Title"}),e.jsx("input",{required:!0,className:"input-field shadow-inner !bg-gray-50/50",placeholder:"e.g. Thermodynamics",value:l.name,onChange:t=>u({...l,name:t.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-primary-400 uppercase tracking-[0.3em] mb-3 ml-1",children:"Academic Level"}),e.jsxs("select",{className:"input-field appearance-none bg-gray-50/50 shadow-inner",value:l.level,onChange:t=>u({...l,level:t.target.value}),children:[e.jsx("option",{value:"100",children:"100 Level"}),e.jsx("option",{value:"200",children:"200 Level"}),e.jsx("option",{value:"300",children:"300 Level"}),e.jsx("option",{value:"400",children:"400 Level"}),e.jsx("option",{value:"500",children:"500 Level"}),e.jsx("option",{value:"PG",children:"Postgraduate"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-primary-400 uppercase tracking-[0.3em] mb-3 ml-1",children:"Semester Cycle"}),e.jsxs("select",{className:"input-field appearance-none bg-gray-50/50 shadow-inner",value:l.semester,onChange:t=>u({...l,semester:t.target.value}),children:[e.jsx("option",{value:"First",children:"First Semester"}),e.jsx("option",{value:"Second",children:"Second Semester"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-primary-400 uppercase tracking-[0.3em] mb-3 ml-1",children:"Credit Weight Protocol"}),e.jsx("div",{className:"grid grid-cols-6 gap-3",children:[1,2,3,4,5,6].map(t=>e.jsx("button",{type:"button",onClick:()=>u({...l,credit_unit:t}),className:`py-4 rounded-2xl font-black text-sm transition-all border ${l.credit_unit===t?"bg-primary-950 text-white border-primary-950 shadow-xl shadow-primary-950/20":"bg-white text-primary-400 border-primary-50 hover:border-primary-200"}`,children:t},t))})]})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsx("button",{type:"button",onClick:o,className:"flex-1 px-8 py-4 border border-gray-100 rounded-2xl text-[10px] font-black uppercase tracking-widest text-gray-400 hover:bg-gray-50 transition-all",children:"Abort"}),e.jsx("button",{type:"submit",disabled:N,className:"btn-primary flex-1",children:N?e.jsx(ee,{className:"w-5 h-5 animate-spin"}):"Authorize Course"})]})]})]})})};Me.propTypes={isOpen:x.bool.isRequired,onClose:x.func.isRequired,onSubmit:x.func.isRequired,courseData:x.shape({name:x.string,code:x.string,credit_unit:x.number,department_id:x.string,level:x.string,semester:x.string}).isRequired,onCourseDataChange:x.func.isRequired,departments:x.arrayOf(x.shape({id:x.string,name:x.string,code:x.string})).isRequired,submitting:x.bool};const Ae=({isOpen:c,onClose:o,onSubmit:i,courseData:l,onCourseDataChange:u,departments:p,submitting:N})=>{if(!c||!l)return null;const w=t=>{t.preventDefault(),i(t)};return e.jsx("div",{className:"fixed inset-0 bg-primary-950/40 backdrop-blur-xl z-50 flex items-center justify-center p-6 animate-in fade-in duration-500",children:e.jsxs("div",{className:"bg-white rounded-[2rem] sm:rounded-[2.5rem] shadow-2xl w-full max-w-lg overflow-hidden border border-white/20 animate-in zoom-in duration-500",children:[e.jsxs("div",{className:"p-8 sm:p-10 border-b border-primary-50 flex items-center justify-between bg-primary-950 text-white relative",children:[e.jsx("div",{className:"absolute inset-x-0 bottom-0 h-1 bg-gradient-to-r from-accent-500 to-transparent"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-black tracking-tighter uppercase italic font-heading",children:"Protocol Modification"}),e.jsx("p",{className:"text-[9px] sm:text-[10px] font-black text-primary-400 uppercase tracking-[0.3em] mt-1 lg:mt-1.5",children:"Official Records"})]}),e.jsx("button",{onClick:o,className:"text-white/50 hover:text-white transition-colors bg-white/5 p-2 sm:p-3 rounded-xl sm:rounded-2xl relative z-10",children:e.jsx(de,{className:"w-5 h-5 sm:w-6 sm:h-6"})})]}),e.jsxs("form",{onSubmit:w,className:"p-8 sm:p-10 space-y-6 sm:space-y-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-primary-400 uppercase tracking-[0.3em] mb-3 ml-1",children:"Course Identity Code"}),e.jsx("input",{required:!0,className:"input-field uppercase font-mono tracking-widest shadow-inner !bg-gray-50/50",value:l.code,onChange:t=>u({...l,code:t.target.value.toUpperCase()})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-primary-400 uppercase tracking-[0.3em] mb-3 ml-1",children:"Departmental Node"}),e.jsxs("select",{required:!0,className:"input-field appearance-none bg-gray-50/50 shadow-inner",value:l.department_id,onChange:t=>u({...l,department_id:t.target.value}),children:[e.jsx("option",{value:"",children:"Select Dept"}),p.map(t=>e.jsxs("option",{value:t.id,children:[t.name," (",t.code,")"]},t.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-primary-400 uppercase tracking-[0.3em] mb-3 ml-1",children:"Official Course Title"}),e.jsx("input",{required:!0,className:"input-field shadow-inner !bg-gray-50/50",value:l.name,onChange:t=>u({...l,name:t.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-primary-400 uppercase tracking-[0.3em] mb-3 ml-1",children:"Academic Level"}),e.jsxs("select",{className:"input-field appearance-none bg-gray-50/50 shadow-inner",value:l.level,onChange:t=>u({...l,level:t.target.value}),children:[e.jsx("option",{value:"100",children:"100 Level"}),e.jsx("option",{value:"200",children:"200 Level"}),e.jsx("option",{value:"300",children:"300 Level"}),e.jsx("option",{value:"400",children:"400 Level"}),e.jsx("option",{value:"500",children:"500 Level"}),e.jsx("option",{value:"PG",children:"Postgraduate"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-primary-400 uppercase tracking-[0.3em] mb-3 ml-1",children:"Semester Cycle"}),e.jsxs("select",{className:"input-field appearance-none bg-gray-50/50 shadow-inner",value:l.semester,onChange:t=>u({...l,semester:t.target.value}),children:[e.jsx("option",{value:"First",children:"First Semester"}),e.jsx("option",{value:"Second",children:"Second Semester"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-primary-400 uppercase tracking-[0.3em] mb-3 ml-1",children:"Credit Weight Protocol"}),e.jsx("div",{className:"grid grid-cols-6 gap-3",children:[1,2,3,4,5,6].map(t=>e.jsx("button",{type:"button",onClick:()=>u({...l,credit_unit:t}),className:`py-4 rounded-2xl font-black text-sm transition-all border ${l.credit_unit===t?"bg-primary-950 text-white border-primary-950 shadow-xl shadow-primary-950/20":"bg-white text-primary-400 border-primary-50 hover:border-primary-200"}`,children:t},t))})]})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsx("button",{type:"button",onClick:o,className:"flex-1 px-8 py-4 border border-gray-100 rounded-2xl text-[10px] font-black uppercase tracking-widest text-gray-400 hover:bg-gray-50 transition-all",children:"Discard"}),e.jsx("button",{type:"submit",disabled:N,className:"btn-primary flex-1",children:N?e.jsx(ee,{className:"w-5 h-5 animate-spin"}):"Confirm Modifications"})]})]})]})})};Ae.propTypes={isOpen:x.bool.isRequired,onClose:x.func.isRequired,onSubmit:x.func.isRequired,courseData:x.shape({id:x.string,name:x.string,code:x.string,credit_unit:x.number,department_id:x.string,level:x.string,semester:x.string}),onCourseDataChange:x.func.isRequired,departments:x.arrayOf(x.shape({id:x.string,name:x.string,code:x.string})).isRequired,submitting:x.bool};const se=j.memo(({courses:c,loading:o,profile:i,myEnrollments:l,submitting:u,onEnroll:p,onEdit:N,onDelete:w})=>o?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[1,2,3,4,5,6].map(t=>e.jsx("div",{className:"h-72 bg-white rounded-[2.5rem] animate-pulse border border-primary-50 shadow-sm"},t))}):c.length===0?e.jsxs("div",{className:"col-span-full py-40 text-center academic-card bg-transparent shadow-none border-dashed border-2 border-primary-100",children:[e.jsx("div",{className:"bg-primary-50 w-32 h-32 rounded-[2.5rem] flex items-center justify-center mx-auto mb-10 border border-primary-100 shadow-inner",children:e.jsx(te,{className:"w-16 h-16 text-primary-200"})}),e.jsx("h3",{className:"text-primary-950 font-black text-3xl mb-4 tracking-tighter italic font-heading uppercase",children:"Curriculum Empty"}),e.jsx("p",{className:"text-gray-400 max-w-sm mx-auto font-bold uppercase tracking-widest text-[10px] leading-loose",children:"The academic catalog is currently waiting for official protocol entries from the registry department."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:c.map(t=>e.jsxs("div",{className:"academic-card group overflow-hidden flex flex-col bg-white hover:bg-gradient-to-br hover:from-white hover:to-primary-50/30",children:[e.jsxs("div",{className:"p-8 sm:p-10 pb-5 sm:pb-6 relative",children:[e.jsx("div",{className:"absolute top-0 right-0 p-6 sm:p-8 opacity-[0.03] pointer-events-none group-hover:scale-110 transition-transform duration-700",children:e.jsx(te,{className:"w-24 h-24 sm:w-32 sm:h-32 text-primary-950"})}),e.jsxs("div",{className:"flex justify-between items-start mb-6 sm:mb-8 relative z-10",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"px-4 sm:px-5 py-1.5 sm:py-2 bg-primary-950 text-white text-[8px] sm:text-[9px] font-black uppercase tracking-[0.3em] rounded-lg sm:rounded-xl shadow-xl shadow-primary-900/20 block w-fit",children:t.code}),e.jsx("p",{className:"text-[9px] sm:text-[10px] font-black text-primary-400 uppercase tracking-[0.2em] mt-2",children:t.departments?.code||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"px-3 py-1 bg-blue-50 text-[9px] font-black uppercase tracking-widest text-blue-600 rounded-lg border border-blue-100",children:[t.credit_unit," Units"]}),e.jsxs("span",{className:"px-3 py-1 bg-amber-50 text-[9px] font-black uppercase tracking-widest text-amber-600 rounded-lg border border-amber-100",children:[t.semester," SEM"]})]})]}),e.jsxs("div",{className:"space-y-3 sm:space-y-4 relative z-10",children:[e.jsx("h3",{className:"text-xl sm:text-2xl font-black text-primary-950 tracking-tighter leading-tight italic font-heading uppercase group-hover:text-primary-600 transition-colors duration-300",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"w-7 h-7 sm:w-8 sm:h-8 rounded-full bg-emerald-50 flex items-center justify-center",children:e.jsx(he,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-emerald-500"})}),e.jsx("p",{className:"text-[9px] sm:text-[10px] font-black text-gray-400 uppercase tracking-[0.2em]",children:"Registry Authenticated"})]})]})]}),e.jsx("div",{className:"mt-auto p-8 sm:p-10 pt-3 sm:pt-4 relative z-10",children:i?.role===I.STUDENT?e.jsx("button",{onClick:()=>p(t.id),disabled:u||l.some(s=>s.course_id===t.id),className:`w-full py-4 sm:py-5 rounded-xl sm:rounded-[1.5rem] font-black text-[9px] sm:text-[10px] uppercase tracking-[0.2em] transition-all transform active:scale-95 shadow-2xl relative overflow-hidden group/btn ${l.some(s=>s.course_id===t.id)?"bg-primary-50 text-primary-700 border border-primary-100 cursor-not-allowed shadow-none":"bg-primary-900 text-white hover:bg-primary-950 hover:-translate-y-1 shadow-primary-900/40"}`,children:e.jsx("span",{className:"relative z-10 flex items-center justify-center gap-2 sm:gap-3",children:l.some(s=>s.course_id===t.id)?e.jsxs(e.Fragment,{children:[e.jsx(he,{className:"w-4 h-4"})," Successfully Enrolled"]}):e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"w-4 h-4 group-hover/btn:rotate-90 transition-transform duration-500"}),"Authorize Enrollment"]})})}):e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:()=>N(t),className:"flex-1 py-4 bg-primary-50 text-primary-950 rounded-[1.25rem] font-black text-[9px] uppercase tracking-[0.2em] hover:bg-primary-100 transition-all border border-primary-100/50 shadow-sm active:scale-95 hover:-translate-y-0.5",children:"Modify"}),i?.role===I.ADMIN&&e.jsx("button",{onClick:()=>w(t.id),className:"p-4 bg-red-50 text-red-500 rounded-[1.25rem] border border-red-100 hover:bg-red-100/50 transition-all active:scale-95 shadow-sm hover:-translate-y-0.5",title:"Revoke Course",children:e.jsx(He,{className:"w-4 h-4"})})]})})]},t.id))}));se.displayName="CourseList";se.propTypes={courses:x.arrayOf(x.shape({id:x.string.isRequired,name:x.string.isRequired,code:x.string.isRequired,credit_unit:x.number.isRequired,semester:x.string.isRequired,departments:x.shape({code:x.string})})).isRequired,loading:x.bool,profile:x.shape({role:x.string}),myEnrollments:x.arrayOf(x.shape({course_id:x.string})),submitting:x.bool,onEnroll:x.func.isRequired,onEdit:x.func.isRequired,onDelete:x.func.isRequired};se.defaultProps={loading:!1,myEnrollments:[],submitting:!1};const xt=()=>{const{profile:c}=qe(),{feedback:o,showFeedback:i}=$e(),{courses:l,loading:u,fetchCourses:p,createCourse:N,updateCourse:w,deleteCourse:t}=it(),[s,r]=j.useState([]),[a,n]=j.useState(null),[h,d]=j.useState("registration"),[g,f]=j.useState({name:"",code:"",credit_unit:3,department_id:"",level:"100",semester:"First"}),[S,k]=j.useState(null),[b,C]=j.useState(""),[M,z]=j.useState([]),[K,U]=j.useState(!1),[O,D]=j.useState([]),[A,ae]=j.useState([]),[V,T]=j.useState(null),[P,F]=j.useState(!1),[B,Z]=j.useState(""),[J,Q]=j.useState(!1),[ie,X]=j.useState(!1),[G,H]=j.useState(null),ne=Qe(B,300),_e=j.useMemo(()=>{if(!ne)return l;const m=ne.toLowerCase();return l.filter(v=>v.name?.toLowerCase().includes(m)||v.code?.toLowerCase().includes(m)||v.departments?.name?.toLowerCase().includes(m))},[l,ne]);j.useEffect(()=>{Pe(),p()},[p]),j.useEffect(()=>{c?.role===I.STUDENT&&a&&me()},[c,a]);const Pe=async()=>{try{const{data:m}=await _.from("departments").select("id, name, code").order("name");r(m||[]);const{data:v}=await _.from("academic_sessions").select("*").eq("is_current",!0).single();n(v)}catch(m){console.error("Error fetching metadata:",m)}},me=async()=>{if(a)try{const{data:m}=await _.from("students").select(`
                    *,
                    profiles:user_id (full_name),
                    departments:department_id (name)
                `).eq("user_id",c.id).single();if(m){T(m);const{data:v}=await _.from("student_courses").select(`
                        course_id,
                        courses (*)
                    `).eq("student_id",m.id).eq("session_id",a.id);ae(v||[])}}catch{i("error","Identity conflict: Could not pull enrollment data.")}},Le=async m=>{if(m.preventDefault(),!g.department_id)return i("error","Departmental node must be authorized.");F(!0);const v=await N(g);v.success?(i("success","Course protocol successfully provisioned."),Q(!1),f({name:"",code:"",credit_unit:3,department_id:"",level:"100",semester:"First"})):i("error",v.error),F(!1)},Ie=async m=>{m.preventDefault(),F(!0);const v=await w(G.id,G);v.success?(i("success","Registry records synchronized successfully."),X(!1),H(null)):i("error",v.error),F(!1)},Oe=async m=>{if(!window.confirm("Are you sure you want to permanently delete this course from the curriculum?"))return;const v=await t(m);v.success?i("success","Security Protocol: Course purged from mainframe."):i("error",v.error)},Te=async m=>{if(C(m),m.length<3)return z([]);U(!0);try{const{data:v}=await _.from("students").select(`
                    id,
                    reg_no,
                    department_id,
                    profiles:user_id (full_name)
                `).or(`reg_no.ilike.%${m}%,profiles.full_name.ilike.%${m}%`).limit(5);z(v||[])}finally{U(!1)}},Fe=async m=>{if(a)try{const{data:v}=await _.from("student_courses").select("course_id").eq("student_id",m).eq("session_id",a.id);D(v?.map(L=>L.course_id)||[])}catch{i("error","Critical error: Could not synchronize student record.")}},ze=async m=>{if(!S||!a)return;const v=O.includes(m);try{if(v){const{error:L}=await _.from("student_courses").delete().eq("student_id",S.id).eq("course_id",m).eq("session_id",a.id);if(L)throw L;D(q=>q.filter(De=>De!==m)),i("success","Registry: Course assigned status revoked.")}else{const{error:L}=await _.from("student_courses").insert([{student_id:S.id,course_id:m,session_id:a.id,semester:l.find(q=>q.id===m)?.semester||"First"}]);if(L)throw L;D(q=>[...q,m]),i("success","Registry: Course provisioned to student.")}await W(v?"admin_unenroll":"admin_enroll","student_courses",m)}catch{i("error","Authorization failure: Request could not be provisioned.")}},Ue=async m=>{if(!a)return i("error","Active academic session not synchronized.");F(!0);try{const{data:v}=await _.from("students").select("id").eq("user_id",c.id).single();if(!v)throw new Error("Student record not found. Please contact administration.");const{error:L}=await _.from("student_courses").insert([{student_id:v.id,course_id:m,session_id:a.id,semester:l.find(q=>q.id===m)?.semester||"First"}]);if(L)throw L.code==="23505"?new Error("Already enrolled in this course for the current session."):L;await W("course_enrollment","student_courses",m),i("success","Authorization success: Enrollment confirmed."),me()}catch(v){i("error",v.message)}finally{F(!1)}},ue=l.filter(m=>A.some(v=>v.course_id===m.id)),Be=ue.reduce((m,v)=>m+v.credit_unit,0);return e.jsxs("div",{className:"space-y-12 animate-slide-up",children:[o.message&&e.jsxs("div",{className:`fixed top-24 right-8 z-[60] p-5 rounded-2xl shadow-2xl border flex items-center gap-4 animate-in slide-in-from-right duration-500 backdrop-blur-xl ${o.type==="error"?"bg-red-50/90 border-red-100 text-red-800":"bg-emerald-50/90 border-emerald-100 text-emerald-800"}`,children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${o.type==="error"?"bg-red-100":"bg-emerald-100"}`,children:o.type==="error"?e.jsx(de,{className:"w-5 h-5"}):e.jsx(ee,{className:"w-5 h-5 animate-spin"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.2em] opacity-50",children:o.type==="error"?"Security Breach":"Protocol Success"}),e.jsx("p",{className:"text-xs font-bold",children:o.message})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-6 sm:gap-8 pb-6 border-b border-primary-100/50 print:hidden",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-10 sm:w-12 h-1 bg-accent-500 rounded-full"}),e.jsx("p",{className:"text-[9px] sm:text-[10px] font-black text-primary-500 uppercase tracking-[0.4em]",children:"Official Curriculum"})]}),e.jsxs("h1",{className:"text-4xl sm:text-5xl font-black text-primary-950 tracking-tighter italic font-heading",children:["Academic ",e.jsx("span",{className:"text-primary-600",children:"Courses"})]})]}),c?.role===I.STUDENT&&e.jsxs("div",{className:"flex gap-4 p-1 bg-primary-100/50 rounded-[1.25rem] w-fit",children:[e.jsxs("button",{onClick:()=>d("registration"),className:`px-6 py-3 rounded-2xl text-[10px] font-black uppercase tracking-[0.2em] transition-all flex items-center gap-2 ${h==="registration"?"bg-white text-primary-950 shadow-lg":"text-primary-500 hover:text-primary-700"}`,children:[e.jsx(te,{className:"w-4 h-4"}),"Course Registration"]}),e.jsxs("button",{onClick:()=>d("my_courses"),className:`px-6 py-3 rounded-2xl text-[10px] font-black uppercase tracking-[0.2em] transition-all flex items-center gap-2 ${h==="my_courses"?"bg-white text-primary-950 shadow-lg":"text-primary-500 hover:text-primary-700"}`,children:[e.jsx(pe,{className:"w-4 h-4"}),"My Registered Courses"]})]}),(c?.role===I.ADMIN||c?.role===I.STAFF)&&e.jsxs("div",{className:"flex gap-4 p-1 bg-primary-100/50 rounded-[1.25rem] w-fit",children:[e.jsxs("button",{onClick:()=>d("registration"),className:`px-6 py-3 rounded-2xl text-[10px] font-black uppercase tracking-[0.2em] transition-all flex items-center gap-2 ${h==="registration"?"bg-white text-primary-950 shadow-lg":"text-primary-500 hover:text-primary-700"}`,children:[e.jsx(te,{className:"w-4 h-4"}),"Curriculum Catalog"]}),e.jsxs("button",{onClick:()=>d("admin_sync"),className:`px-6 py-3 rounded-2xl text-[10px] font-black uppercase tracking-[0.2em] transition-all flex items-center gap-2 ${h==="admin_sync"?"bg-white text-primary-950 shadow-lg":"text-primary-500 hover:text-primary-700"}`,children:[e.jsx(pe,{className:"w-4 h-4"}),"Student Enrollment Sync"]})]}),c?.role===I.ADMIN&&e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:()=>Q(!0),className:"btn-primary group w-full sm:w-auto",children:[e.jsx(fe,{className:"w-4 h-4 group-hover:rotate-90 transition-transform duration-500"}),"Provision New Course"]})})]}),(c?.role===I.ADMIN||c?.role===I.STAFF)&&h==="admin_sync"&&e.jsxs("div",{className:"space-y-8 animate-slide-up",children:[e.jsxs("div",{className:"academic-card p-8 bg-white shadow-2xl shadow-primary-950/5 border border-primary-50 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-12 opacity-[0.02] pointer-events-none",children:e.jsx(le,{className:"w-40 h-40 text-primary-900"})}),e.jsxs("div",{className:"relative z-10 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-primary-950 uppercase tracking-tighter italic font-heading mb-2",children:"Student Identity Search"}),e.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mb-6 leading-loose",children:"Search by Matriculation Number or Full Name to provision academic pathways."}),e.jsxs("div",{className:"relative max-w-2xl",children:[e.jsx(le,{className:"absolute left-6 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-300"}),e.jsx("input",{type:"text",placeholder:"Enter Student Identifier...",className:"w-full pl-16 pr-8 py-5 bg-primary-50/50 border border-primary-100 rounded-[1.5rem] focus:outline-none focus:ring-2 focus:ring-primary-500/20 font-bold placeholder:text-gray-300 text-sm",value:b,onChange:m=>Te(m.target.value)}),K&&e.jsx(ee,{className:"absolute right-6 top-1/2 -translate-y-1/2 h-5 w-5 text-primary-500 animate-spin"})]})]}),M.length>0&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-8 animate-in slide-in-from-top duration-500",children:M.map(m=>e.jsxs("button",{onClick:()=>{k(m),Fe(m.id),z([]),C("")},className:"flex items-center gap-4 p-4 bg-white border border-primary-100 rounded-2xl hover:bg-primary-50 transition-all text-left group shadow-sm",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-primary-900 flex items-center justify-center text-white text-xs font-black",children:m.reg_no.slice(-2)}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-black text-primary-950 group-hover:text-primary-600 transition-colors uppercase italic",children:m.profiles?.full_name}),e.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest",children:m.reg_no})]})]},m.id))})]})]}),S&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mt-12 animate-slide-up",children:[e.jsx("div",{className:"lg:col-span-1 space-y-6",children:e.jsxs("div",{className:"academic-card p-8 bg-primary-950 text-white shadow-2xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-10 pointer-events-none",children:e.jsx(Ye,{className:"w-32 h-32"})}),e.jsx("h4",{className:"text-[10px] font-black uppercase tracking-[0.4em] text-primary-400 mb-6",children:"Active Target Identity"}),e.jsx("h3",{className:"text-2xl font-black italic tracking-tighter uppercase font-heading mb-2",children:S.profiles?.full_name}),e.jsx("p",{className:"text-xl font-bold text-primary-200 mb-8",children:S.reg_no}),e.jsxs("div",{className:"pt-6 border-t border-white/10 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center text-[10px] font-black uppercase tracking-widest",children:[e.jsx("span",{className:"text-primary-400",children:"Enrollment Count"}),e.jsxs("span",{className:"px-3 py-1 bg-white/10 rounded-lg",children:[O.length," Courses"]})]}),e.jsx("button",{onClick:()=>k(null),className:"w-full py-4 bg-white/5 hover:bg-white/10 text-white rounded-xl text-[10px] font-black uppercase tracking-widest transition-all border border-white/10",children:"Reset Context"})]})]})}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsx("h3",{className:"text-xl font-black text-primary-950 uppercase tracking-tighter italic font-heading",children:"Curriculum Authorization Matrix"}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:l.map(m=>e.jsxs("div",{className:"academic-card p-6 flex items-center justify-between bg-white border border-primary-50 hover:shadow-xl transition-all group",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:`w-14 h-14 rounded-2xl flex items-center justify-center font-black text-xs border ${O.includes(m.id)?"bg-emerald-50 text-emerald-600 border-emerald-100":"bg-gray-50 text-gray-400 border-gray-100"}`,children:m.code.split(" ")[0]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-black text-primary-950 uppercase italic tracking-tight",children:m.name}),e.jsxs("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest",children:[m.code," â€¢ ",m.credit_unit," Units"]})]})]}),e.jsx("button",{onClick:()=>ze(m.id),className:`px-8 py-3 rounded-xl text-[9px] font-black uppercase tracking-widest transition-all ${O.includes(m.id)?"bg-red-50 text-red-600 hover:bg-red-100 border border-red-100":"bg-primary-900 text-white hover:bg-primary-950 shadow-lg shadow-primary-900/20"}`,children:O.includes(m.id)?"Revoke Access":"Authorize Entry"})]},m.id))})]})]})]}),c?.role===I.STUDENT&&h==="my_courses"&&e.jsxs("div",{className:"space-y-8 animate-slide-up",children:[e.jsx("div",{className:"flex justify-end mb-4 print:hidden",children:e.jsxs("button",{onClick:()=>window.print(),className:"flex items-center gap-2 px-6 py-3 bg-primary-950 text-white rounded-xl text-[10px] font-black uppercase tracking-widest hover:bg-primary-900 transition-all shadow-xl",children:[e.jsx(Ve,{className:"w-4 h-4"}),"Print Form"]})}),e.jsx("div",{className:"print:m-0 print:p-0",children:e.jsx(at,{courses:ue,student:{full_name:V?.profiles?.full_name,matric_no:V?.reg_no},totalUnits:Be})})]}),(h==="registration"||!c)&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"academic-card p-2 sm:p-4 flex flex-col md:flex-row gap-4 items-center bg-white shadow-2xl shadow-primary-950/5",children:e.jsxs("div",{className:"relative flex-1 group w-full",children:[e.jsx(le,{className:"absolute left-5 sm:left-6 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-300 transition-colors group-focus-within:text-primary-600"}),e.jsx("input",{type:"text",placeholder:"Search the curriculum by title or course identifier...",className:"w-full pl-14 sm:pl-16 pr-6 sm:pr-8 py-4 sm:py-5 bg-transparent rounded-2xl focus:outline-none font-medium placeholder:text-gray-300 text-sm",value:B,onChange:m=>Z(m.target.value)})]})}),e.jsx(se,{courses:_e,loading:u,profile:c,myEnrollments:A,submitting:P,onEnroll:Ue,onEdit:m=>{H({...m}),X(!0)},onDelete:Oe}),e.jsx(Me,{isOpen:J,onClose:()=>Q(!1),onSubmit:Le,courseData:g,onCourseDataChange:f,departments:s,submitting:P}),e.jsx(Ae,{isOpen:ie&&!!G,onClose:()=>{X(!1),H(null)},onSubmit:Ie,courseData:G,onCourseDataChange:H,departments:s,submitting:P})]})]})};export{xt as default};
